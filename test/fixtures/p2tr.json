{
  "valid": [
    {
      "description": "output and pubkey from address",
      "arguments": {
        "address": "bc1p4dss6gkgq8003g0qyd5drwfqrztsadf2w2v3juz73gdz7cx82r6sj7lcqx"
      },
      "options": {},
      "expected": {
        "name": "p2tr",
        "output": "OP_1 ab610d22c801def8a1e02368d1b92018970eb52a729919705e8a1a2f60c750f5",
        "pubkey": "ab610d22c801def8a1e02368d1b92018970eb52a729919705e8a1a2f60c750f5",
        "signature": null,
        "input": null,
        "witness": null
      }
    },
    {
      "description": "address and pubkey from output",
      "arguments": {
        "output": "OP_1 ab610d22c801def8a1e02368d1b92018970eb52a729919705e8a1a2f60c750f5"
      },
      "expected": {
        "name": "p2tr",
        "address": "bc1p4dss6gkgq8003g0qyd5drwfqrztsadf2w2v3juz73gdz7cx82r6sj7lcqx",
        "pubkey": "ab610d22c801def8a1e02368d1b92018970eb52a729919705e8a1a2f60c750f5",
        "signature": null,
        "input": null,
        "witness": null
      }
    },
    {
      "description": "address and output from pubkey",
      "arguments": {
        "pubkey": "ab610d22c801def8a1e02368d1b92018970eb52a729919705e8a1a2f60c750f5"
      },
      "expected": {
        "name": "p2tr",
        "address": "bc1p4dss6gkgq8003g0qyd5drwfqrztsadf2w2v3juz73gdz7cx82r6sj7lcqx",
        "output": "OP_1 ab610d22c801def8a1e02368d1b92018970eb52a729919705e8a1a2f60c750f5",
        "signature": null,
        "input": null,
        "witness": null
      }
    },
    {
      "description": "address, output and witness from pubkey and signature",
      "arguments": {
        "pubkey": "ab610d22c801def8a1e02368d1b92018970eb52a729919705e8a1a2f60c750f5",
        "signature": "300602010002010001"
      },
      "expected": {
        "name": "p2tr",
        "address": "bc1p4dss6gkgq8003g0qyd5drwfqrztsadf2w2v3juz73gdz7cx82r6sj7lcqx",
        "output": "OP_1 ab610d22c801def8a1e02368d1b92018970eb52a729919705e8a1a2f60c750f5",
        "input": null,
        "witness": [
          "300602010002010001"
        ]
      }
    },
    {
      "description": "address, output and signature from pubkey and witness",
      "arguments": {
        "pubkey": "ab610d22c801def8a1e02368d1b92018970eb52a729919705e8a1a2f60c750f5",
        "witness": [
          "300602010002010001"
        ]
      },
      "expected": {
        "name": "p2tr",
        "address": "bc1p4dss6gkgq8003g0qyd5drwfqrztsadf2w2v3juz73gdz7cx82r6sj7lcqx",
        "output": "OP_1 ab610d22c801def8a1e02368d1b92018970eb52a729919705e8a1a2f60c750f5",
        "input": null,
        "signature": "300602010002010001",
        "witness": [
          "300602010002010001"
        ]
      }
    },
    {
      "description": "address, pubkey and output from internalPubkey",
      "arguments": {
        "internalPubkey": "9fa5ffb68821cf559001caa0577eeea4978b29416def328a707b15e91701a2f7"
      },
      "expected": {
        "name": "p2tr",
        "address": "bc1prs7pxymu7jhsptzjlwlqnk8jyg5qmq4sdlc3rwcy7pd3ydz92xjq5ap2sg",
        "pubkey": "1c3c13137cf4af00ac52fbbe09d8f222280d82b06ff111bb04f05b12344551a4",
        "output": "OP_1 1c3c13137cf4af00ac52fbbe09d8f222280d82b06ff111bb04f05b12344551a4",
        "signature": null,
        "input": null,
        "witness": null
      }
    },
    {
      "description": "address, pubkey, output and hash from internalPubkey and a script tree with one leaf",
      "arguments": {
        "internalPubkey": "50929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac0",
        "scriptsTree": [
          {
            "output": "83d8ee77a0f3a32a5cea96fd1624d623b836c1e5d1ac2dcde46814b619320c18 OP_CHECKSIG"
          }
        ]
      },
      "expected": {
        "name": "p2tr",
        "address": "bc1pjegs09vkeder9m4sw3ycjf2rnpa8nljdqmuleunk9eshu8cq3xysvhgp2u",
        "pubkey": "9651079596cb7232eeb07449892543987a79fe4d06f9fcf2762e617e1f008989",
        "output": "OP_1 9651079596cb7232eeb07449892543987a79fe4d06f9fcf2762e617e1f008989",
        "hash": "16e3f3b8b9c1e453c56b547785cdd25259d65823a2064f30783acc58ef012633",
        "signature": null,
        "input": null,
        "witness": null
      }
    },
    {
      "description": "address, pubkey, output and hash from internalPubkey and a script tree with two leafs",
      "arguments": {
        "internalPubkey": "2258b1c3160be0864a541854eec9164a572f094f7562628281a8073bb89173a7",
        "scriptsTree": [
          {
            "output": "d826a0a53abb6ffc60df25b9c152870578faef4b2eb5a09bdd672bbe32cdd79b OP_CHECKSIG"
          },
          {
            "output": "d826a0a53abb6ffc60df25b9c152870578faef4b2eb5a09bdd672bbe32cdd79b OP_CHECKSIG"
          }
        ]
      },
      "expected": {
        "name": "p2tr",
        "address": "bc1ptj0v8rwcj6s36p4r26ws6htx0fct43n0mxdvdeh9043whlxlq3kq9965ke",
        "pubkey": "5c9ec38dd896a11d06a3569d0d5d667a70bac66fd99ac6e6e57d62ebfcdf046c",
        "output": "OP_1 5c9ec38dd896a11d06a3569d0d5d667a70bac66fd99ac6e6e57d62ebfcdf046c",
        "hash": "ce00198cd4667abae1f94aa5862d089e2967af5aec20715c692db74e3d66bb73",
        "signature": null,
        "input": null,
        "witness": null
      }
    },
    {
      "description": "address, pubkey, output and hash from internalPubkey and a script tree with three leafs",
      "arguments": {
        "internalPubkey": "7631cacec3343052d87ef4d0065f61dde82d7d2db0c1cc02ef61ef3c982ea763",
        "scriptsTree": [
          {
            "output": "50929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac0 OP_CHECKSIG"
          },
          [
            {
              "output": "50929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac0 OP_CHECKSIG"
            },
            {
              "output": "9b4d495b74887815a1ff623c055c6eac6b6b2e07d2a016d6526ebac71dd99744 OP_CHECKSIG"
            }
          ]
        ]
      },
      "expected": {
        "name": "p2tr",
        "address": "bc1pkq0t8nkmqswn3qjg9uy6ux2hsyyz4as25v8unfjc9s8q2e4c00sqku9lxh",
        "pubkey": "b01eb3cedb041d3882482f09ae195781082af60aa30fc9a6582c0e0566b87be0",
        "output": "OP_1 b01eb3cedb041d3882482f09ae195781082af60aa30fc9a6582c0e0566b87be0",
        "hash": "7ae0cc2057b1a7bf0e09c787e1d7b6b2355ac112a7b80380a5c1e942155b0c0f",
        "signature": null,
        "input": null,
        "witness": null
      }
    },
    {
      "description": "address, pubkey, output and hash from internalPubkey and a script tree with four leafs",
      "arguments": {
        "internalPubkey": "d0c19def28bb1b39451c1a814737615983967780d223b79969ba692182c6006b",
        "scriptsTree": [
          [
            {
              "output": "9b4d495b74887815a1ff623c055c6eac6b6b2e07d2a016d6526ebac71dd99744 OP_CHECKSIG"
            },
            {
              "output": "50929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac0 OP_CHECKSIG"
            }
          ],
          [
            {
              "output": "50929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac0 OP_CHECKSIG"
            },
            {
              "output": "9b4d495b74887815a1ff623c055c6eac6b6b2e07d2a016d6526ebac71dd99744 OP_CHECKSIG"
            }
          ]
        ]
      },
      "expected": {
        "name": "p2tr",
        "address": "bc1pstdzevc40j059s0473rghhv9e05l9f5xv7l6dtlavvq22rzfna3syjvjut",
        "pubkey": "82da2cb3157c9f42c1f5f4468bdd85cbe9f2a68667bfa6affd6300a50c499f63",
        "output": "OP_1 82da2cb3157c9f42c1f5f4468bdd85cbe9f2a68667bfa6affd6300a50c499f63",
        "hash": "d673e784eac9b70289130a0bd359023a0fbdde51dc069b9efb4157c2cdce3ea5",
        "signature": null,
        "input": null,
        "witness": null
      }
    },
    {
      "description": "address, pubkey, output and hash from internalPubkey and a script tree with seven leafs",
      "arguments": {
        "internalPubkey": "f95886b02a84928c5c15bdca32784993105f73de27fa6ad8c1a60389b999267c",
        "scriptsTree": [
          [
            {
              "output": "50929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac0 OP_CHECKSIG"
            },
            [
              {
                "output": "50929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac0 OP_CHECKSIG"
              },
              {
                "output": "2258b1c3160be0864a541854eec9164a572f094f7562628281a8073bb89173a7 OP_CHECKSIG"
              }
            ]
          ],
          [
            {
              "output": "50929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac0 OP_CHECKSIG"
            },
            [
              {
                "output": "50929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac0 OP_CHECKSIG"
              },
              [
                {
                  "output": "50929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac0 OP_CHECKSIG"
                },
                {
                  "output": "03a669ea926f381582ec4a000b9472ba8a17347f5fb159eddd4a07036a6718eb OP_CHECKSIG"
                }
              ]
            ]
          ]
        ]
      },
      "expected": {
        "name": "p2tr",
        "address": "bc1pfas4r5s5208puwzj20hvwg2dw2kanc06yxczzdd66729z63pk43q7zwlu6",
        "pubkey": "4f6151d21453ce1e385253eec7214d72add9e1fa21b02135bad794516a21b562",
        "output": "OP_1 4f6151d21453ce1e385253eec7214d72add9e1fa21b02135bad794516a21b562",
        "hash": "16fb2e99bdf86f67ee6980d0418658f15df7e19476053b58f45a89df2e219b1b",
        "signature": null,
        "input": null,
        "witness": null
      }
    },
    {
      "description": "address, pubkey, output and hash from internalPubkey and a script tree with seven leafs (2)",
      "arguments": {
        "internalPubkey": "aba457d16a8d59151c387f24d1eb887efbe24644c1ee64b261282e7baebdb247",
        "scriptsTree": [
          {
            "output": "00a9da96087a72258f83b338ef7f0ea8cbbe05da5f18f091eb397d1ecbf7c3d3 OP_CHECKSIG"
          },
          [
            [
              {
                "output": "00a9da96087a72258f83b338ef7f0ea8cbbe05da5f18f091eb397d1ecbf7c3d3 OP_CHECKSIG"
              },
              [
                {
                  "output": "50929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac0 OP_CHECKSIG"
                },
                {
                  "output": "50929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac0 OP_CHECKSIG"
                }
              ]
            ],
            [
              [
                {
                  "output": "50929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac0 OP_CHECKSIG"
                },
                {
                  "output": "50929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac0 OP_CHECKSIG"
                }
              ],
              {
                "output": "00a9da96087a72258f83b338ef7f0ea8cbbe05da5f18f091eb397d1ecbf7c3d3 OP_CHECKSIG"
              }
            ]
          ]
        ]
      },
      "expected": {
        "name": "p2tr",
        "address": "bc1pmu8qwr9zljs9anger0d6q3uyr43yzjetmjmzf8p93ltycrwj28lsee3e0n",
        "pubkey": "df0e070ca2fca05ecd191bdba047841d62414b2bdcb6249c258fd64c0dd251ff",
        "output": "OP_1 df0e070ca2fca05ecd191bdba047841d62414b2bdcb6249c258fd64c0dd251ff",
        "hash": "027391d0aac8d94725e4fcec4b07214d7c8a14bcdca2b1c08e4bc786308bdae5",
        "signature": null,
        "input": null,
        "witness": null
      }
    }
  ],
  "invalid": [
    {
      "exception": "Not enough data",
      "arguments": {}
    },
    {
      "exception": "Not enough data",
      "arguments": {
        "signature": "300602010002010001"
      }
    },
    {
      "description": "Incorrect Witness Version",
      "exception": "Output is invalid",
      "arguments": {
        "output": "OP_0 ab610d22c801def8a1e02368d1b92018970eb52a729919705e8a1a2f60c750f5"
      }
    },
    {
      "description": "Invalid x coordinate for pubkey in pubkey",
      "exception": "Invalid pubkey for p2tr",
      "arguments": {
        "pubkey": "f136e956540197c21ff3c075d32a6e3c82f1ee1e646cc0f08f51b0b5edafa762"
      }
    },
    {
      "description": "Invalid x coordinate for pubkey in output",
      "exception": "Invalid pubkey for p2tr",
      "arguments": {
        "output": "OP_1 f136e956540197c21ff3c075d32a6e3c82f1ee1e646cc0f08f51b0b5edafa762"
      }
    },
    {
      "description": "Invalid x coordinate for pubkey in address",
      "exception": "Invalid pubkey for p2tr",
      "arguments": {
        "address": "bc1p7ymwj4j5qxtuy8lncp6ax2nw8jp0rms7v3kvpuy02xcttmd05a3qmwlnez"
      }
    },
    {
      "description": "Pubkey mismatch between pubkey and output",
      "exception": "Pubkey mismatch",
      "options": {},
      "arguments": {
        "pubkey": "ab610d22c801def8a1e02368d1b92018970eb52a729919705e8a1a2f60c750f5",
        "output": "OP_1 12d7dac98d69a086a50b30959a3537950f356ffc6f50a263ab75c8a3ec9d44c1"
      }
    },
    {
      "description": "Pubkey mismatch between pubkey and address",
      "exception": "Pubkey mismatch",
      "options": {},
      "arguments": {
        "pubkey": "ab610d22c801def8a1e02368d1b92018970eb52a729919705e8a1a2f60c750f5",
        "address": "bc1pztta4jvddxsgdfgtxz2e5dfhj58n2mludag2ycatwhy28myagnqsnl7mv7"
      }
    },
    {
      "description": "Pubkey mismatch between output and address",
      "exception": "Pubkey mismatch",
      "options": {},
      "arguments": {
        "output": "OP_1 ab610d22c801def8a1e02368d1b92018970eb52a729919705e8a1a2f60c750f5",
        "address": "bc1pztta4jvddxsgdfgtxz2e5dfhj58n2mludag2ycatwhy28myagnqsnl7mv7"
      }
    },
    {
      "description": "Pubkey mismatch between internalPubkey and pubkey",
      "exception": "Pubkey mismatch",
      "options": {},
      "arguments": {
        "internalPubkey": "9fa5ffb68821cf559001caa0577eeea4978b29416def328a707b15e91701a2f7",
        "pubkey": "ab610d22c801def8a1e02368d1b92018970eb52a729919705e8a1a2f60c750f5"
      }
    },
    {
      "exception": "Invalid internalPubkey for p2t",
      "options": {},
      "arguments": {
        "internalPubkey": "9fa5ffb68821cf559001caa0577eeea4978b29416def328a707b15e91701a2f8"
      }
    },
    {
      "exception": "Signature mismatch",
      "arguments": {
        "pubkey": "ab610d22c801def8a1e02368d1b92018970eb52a729919705e8a1a2f60c750f5",
        "signature": "300602010002010002",
        "witness": [
          "300602010002010001"
        ]
      }
    },
    {
      "exception": "Invalid prefix or Network mismatch",
      "arguments": {
        "address": "bcrt1prhepe49mpmhclwcqmkzpaz43revunykc7fc0f9az6pq08sn4qe7sxtrd8y"
      }
    },
    {
      "exception": "Invalid address version",
      "arguments": {
        "address": "bc1z4dss6gkgq8003g0qyd5drwfqrztsadf2w2v3juz73gdz7cx82r6s6rxhwd"
      }
    },
    {
      "exception": "Invalid address data",
      "arguments": {
        "address": "bc1p4dss6gkgq8003g0qyd5drwfqrztsadf2w2v3juz73gdz7cx82qh3d2w3"
      }
    },
    {
      "exception": "Witness is invalid",
      "arguments": {
        "address": "bc1p4dss6gkgq8003g0qyd5drwfqrztsadf2w2v3juz73gdz7cx82r6sj7lcqx",
        "witness": []
      }
    }
  ],
  "dynamic": {
    "depends": {},
    "details": []
  }
}